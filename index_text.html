<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROS 2 WebSocket Subscriber</title>
</head>
<body>
    <h1>ROS 2 WebSocket Subscriber</h1>
    <div id="message-container"></div>

    <script>
        const socket = new WebSocket('ws://localhost:9090'); // ROS 2 웹 소켓 포트
        const topicName = '/heendy_text'; // 노드에서 사용하는 토픽 이름

        socket.addEventListener('open', (event) => {
            console.log('웹 소켓 연결이 열렸습니다.');
            socket.send(JSON.stringify({
                op: 'subscribe',
                topic: topicName,
                type: 'std_msgs/String',
            }));
        });

        socket.addEventListener('message', (event) => {
            const message = JSON.parse(event.data);
            console.log('수신된 메시지:', message);

            // 수신된 메시지를 HTML에 갱신
            const messageContainer = document.getElementById('message-container');
            if (message.op === 'publish' && message.topic === topicName) {
                messageContainer.innerHTML = '<p>수신된 메시지: ' + message.msg.data + '</p>';
            }
        });

        socket.addEventListener('close', (event) => {
            console.log('웹 소켓 연결이 닫혔습니다.');
        });

        socket.addEventListener('error', (event) => {
            console.error('웹 소켓 오류:', event);
        });
    </script>
</body>
</html>